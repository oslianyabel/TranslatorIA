# YML-Multilanguage

1. install python 3.9

    ``` bash
    sudo add-apt-repository ppa:deadsnakes/ppa
    sudo apt install python3.9
    python3.9 --version
    ```

2. install ffmpeg

    ``` bash
    sudo apt install ffmpeg
    ```

3. install miniconda following the instruction at : https://docs.conda.io/projects/miniconda/en/latest/ 

4. clone the repository 

5. Install pyannote using conda pytorch:

    ```
    pip install -r requirements.txt

    conda create -n conda_pyannote python=3.9

    conda activate conda_pyannote

    cd src/app

    conda install pytorch==1.11.0 torchvision==0.12.0 torchaudio==0.11.0 -c pytorch

    pip install -qq https://github.com/pyannote/pyannote-audio/archive/develop.zip

    ```

6. Install mysql
   
    ```
    sudo apt install mysql-server
    
    sudo apt install libmysqlclient-dev

    mysql --version

    sudo mysql_secure_installation

    sudo mysql -u root -p

        mysql> CREATE USER 'yml'@'localhost' IDENTIFIED BY 'new_password';

        mysql> GRANT ALL PRIVILEGES ON *. * TO 'yml'@'localhost';

        mysql> CREATE DATABASE YML_Multilanguage CHARACTER SET UTF8;

        mysql> 

    ```
- in settings.py: 
    ```
    DATABASES = {

            'default': {
            
            'ENGINE': 'django.db.backends.mysql',

            'NAME': 'YML_Multilanguage',

            'USER': 'your_new_username',

            'PASSWORD': 'new_password',

            'HOST': 'localhost', # needed if running MySQL in a virtual server or a separate server

            'PORT': '3307',# needed if running MySQL in a virtual server or a separate server

                        }

            }

    ```

7.  To execute it:

    activate the python enviroment if exists
    ```
    conda activate conda_pyannote # conda info --envs

    cd src/app

    python3 manage.py runserver 0.0.0.0:8000

    ```
    if port is busy: sudo fuser -k 8000/tcp
    
    connect through `https://yml-multilanguage.com:8000`
   
8. To activate User Registration Email Confirmation, you need a gmail account for the web page. 

    Once logged in that account go to settings: https://myaccount.google.com/security

    - Manage your google accounts
    - Security
    - 2-Step Verification
    - App passwords
    - Generate a new app named, for example: YML-Multilanguage
    - Copy the password and put in settings.py at:
        EMAIL_HOST_PASSWORD = '16-digit code generated by gmail in 2-factor authentication'  
    - also save the email address at: 
        EMAIL_HOST_USER = 'page email account' 

9. To sign-up and login using google directly:
    
    - Go to https://console.developers.google.com/
    - Dashboard
    - Create a New Project, named YML-Multilanguage
    - Go to "OAuth consent screen"
        'App name' : YML-Multilanguage
        'User support email' : the email created in the previous section
    
    - Go to "Credentials"
    - Create Credentials
    - OAuth Client ID
    - On 'Authorized JavaScript origins' add the address to the web page or:
        http://localhost:8000
        http://127.0.0.1:8000
    - On 'Authorized redirect URIs' 
        http://127.0.0.1:8000/accounts/google/login/callback/
        http://localhost:8000/accounts/google/login/callback/
    - Create
    - Copy Client ID and Client secret
    - Copy those values in settings.py to: 
        SOCIAL_AUTH_GOOGLE_OAUTH2_KEY = '##################################'
        SOCIAL_AUTH_GOOGLE_OAUTH2_SECRET = '###########################'

10. Internatioalization  I18N
    
    sudo apt-get -y install gettext
    
<!-- 10. Install stripe
    
    ```
    curl -s https://packages.stripe.dev/api/security/keypair/stripe-cli-gpg/public | gpg --dearmor | sudo tee /usr/share/keyrings/stripe.gpg

    echo "deb [signed-by=/usr/share/keyrings/stripe.gpg] https://packages.stripe.dev/stripe-cli-debian-local stable main" | sudo tee -a /etc/apt/sources.list.d/stripe.list

    sudo apt update

    sudo apt install stripe

    stripe login
    ``` -->

python manage.py makemigrations
python manage.py migrate
